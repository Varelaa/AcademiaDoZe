<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui" 
xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml" 
xmlns:vm="clr-namespace:AcademiaDoZe.Presentation.AppMaui.ViewModels" 
xmlns:dto="clr-namespace:AcademiaDoZe.Application.DTOs;assembly=AcademiaDoZe.Application"
x:Class="AcademiaDoZe.Presentation.AppMaui.Views.LogradouroListPage" 
x:DataType="vm:LogradouroListViewModel" Title="{Binding Title}">
	<Grid RowDefinitions="Auto,*">
		<!-- Barra de busca -->
		<Border Grid.Row="0" Style="{StaticResource CardBorder}" Margin="15,10">
			<Grid ColumnDefinitions="Auto,10,*,10,Auto" VerticalOptions="Center">
				<Picker Grid.Column="0" ItemsSource="{Binding FilterTypes}" SelectedItem="{Binding SelectedFilterType}" WidthRequest="110" HeightRequest="40"/>
				<Entry Grid.Column="2" Text="{Binding SearchText}" Placeholder="Digite o valor..." HeightRequest="40"/>
				<Button Grid.Column="4" Text="Buscar" Style="{StaticResource ButtonPrimary}" WidthRequest="80" HeightRequest="40" Command="{Binding SearchLogradourosCommand}"/>
			</Grid>
		</Border>
		<!-- Lista -->
		<Grid Grid.Row="1">
			<RefreshView IsRefreshing="{Binding IsRefreshing}" Command="{Binding RefreshCommand}">
				<CollectionView ItemsSource="{Binding Logradouros}" SelectionMode="None">
					<CollectionView.EmptyView>
						<StackLayout VerticalOptions="Center">
							<Label Text="Nenhum logradouro encontrado" HorizontalOptions="Center" Style="{StaticResource SubHeadline}"/>
							<Button Text="Adicionar Primeiro Logradouro" Command="{Binding AddLogradouroCommand}" Style="{StaticResource ButtonPrimary}" HeightRequest="50" Margin="0,20,0,0"/>
						</StackLayout>
					</CollectionView.EmptyView>
					<CollectionView.ItemTemplate>
						<DataTemplate x:DataType="dto:LogradouroDTO">
							<Grid Padding="1" Margin="5">
								<Border Style="{StaticResource CardBorder}" Margin="10">
									<Grid RowDefinitions="Auto,Auto,Auto,Auto,Auto" ColumnDefinitions="*,Auto,Auto">
										<Label Grid.Row="0" Grid.Column="0" Text="{Binding Cep}" FontAttributes="Bold"/>
										<Label Grid.Row="1" Text="{Binding Nome}"/>
										<Label Grid.Row="2" Text="{Binding Bairro}"/>
										<Label Grid.Row="3">
											<Label.FormattedText>
												<FormattedString>
													<Span Text="{Binding Cidade}"/>
													<Span Text=" - "/>
													<Span Text="{Binding Estado}"/>
												</FormattedString>
											</Label.FormattedText>
										</Label>
										<Label Grid.Row="4" Text="{Binding Pais}"/>
										<Button Grid.Row="0" Grid.Column="1" Text="Editar" Style="{StaticResource ButtonSmall}" Clicked="OnEditButtonClicked"/>
										<Button Grid.Row="0" Grid.Column="2" Text="Excluir" Style="{StaticResource ButtonDanger}" Clicked="OnDeleteButtonClicked"/>
									</Grid>
								</Border>
							</Grid>
						</DataTemplate>
					</CollectionView.ItemTemplate>
				</CollectionView>
			</RefreshView>
			<!-- BotÃ£o flutuante -->
			<Button Text="+" Command="{Binding AddLogradouroCommand}" Style="{StaticResource ButtonPrimary}" WidthRequest="56" HeightRequest="56" HorizontalOptions="End" VerticalOptions="End" Margin="20">
				<Button.Shadow>
					<Shadow Brush="{AppThemeBinding Light=Black, Dark=Gray}" Offset="0,4" Radius="8" Opacity="0.3"/>
				</Button.Shadow>
			</Button>
		</Grid>
		<!-- Loading -->
		<ActivityIndicator Grid.Row="0" Grid.RowSpan="2" IsVisible="{Binding IsBusy}" IsRunning="{Binding IsBusy}"/>
	</Grid>
</ContentPage>
